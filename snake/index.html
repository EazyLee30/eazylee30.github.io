<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Snake - eazylee</title>
  <link rel="stylesheet" href="/assets/css/main.css" />
  <style>
    .game-container {
      max-width: 800px;
      margin: 0 auto;
    }

    .game-canvas-container {
      display: flex;
      justify-content: center;
      margin: 2rem 0;
    }

    #gameCanvas {
      border: 2px solid #00ff00;
      background: #000000;
      display: block;
    }

    .game-info {
      text-align: center;
      color: #00ff00;
      margin: 1rem 0;
      font-size: 1.1rem;
    }

    .game-controls {
      text-align: center;
      margin: 1.5rem 0;
    }

    .game-btn {
      background: #000000;
      color: #00ff00;
      border: 1px solid #00ff00;
      padding: 0.5rem 1.5rem;
      font-family: 'Share Tech Mono', 'Courier New', monospace;
      font-size: 1rem;
      cursor: pointer;
      margin: 0 0.5rem;
      transition: all 0.3s ease;
    }

    .game-btn:hover {
      background: #00ff00;
      color: #000000;
    }

    .instructions {
      color: #00ff00;
      font-size: 0.9rem;
      margin-top: 1rem;
      line-height: 1.6;
      text-align: center;
    }

    .game-over-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.9);
      z-index: 10000;
      align-items: center;
      justify-content: center;
    }

    .game-over-content {
      border: 2px solid #00ff00;
      background: #000000;
      padding: 3rem;
      max-width: 500px;
      width: 90%;
      text-align: center;
    }

    .game-over-title {
      font-size: 2rem;
      color: #00ff00;
      margin-bottom: 1.5rem;
    }

    .game-over-score {
      font-size: 1.5rem;
      color: #ffffff;
      margin-bottom: 2rem;
    }

    .name-input-label {
      display: block;
      color: #00ff00;
      font-size: 1.2rem;
      margin-bottom: 1rem;
    }

    .name-input {
      width: 100%;
      padding: 0.8rem;
      background: #000000;
      border: 1px solid #00ff00;
      color: #00ff00;
      font-family: 'Share Tech Mono', 'Courier New', monospace;
      font-size: 1rem;
      margin-bottom: 1.5rem;
      outline: none;
    }

    .name-input:focus {
      border-color: #ffffff;
      box-shadow: 0 0 10px rgba(0, 255, 0, 0.5);
    }

    .submit-btn {
      background: #000000;
      color: #00ff00;
      border: 1px solid #00ff00;
      padding: 0.8rem 2rem;
      font-family: 'Share Tech Mono', 'Courier New', monospace;
      font-size: 1rem;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .submit-btn:hover {
      background: #00ff00;
      color: #000000;
    }
  </style>
</head>
<body>
  <main class="page-content" aria-label="Content">
    <div class="w">
      <div class="content-wrapper">
        <div class="text-content">
          <header>
            <h1>snake game <a href="../game.html" class="lang-switch">back</a></h1>
            <p>
              <div class="game-container">
                <div class="game-canvas-container">
                  <canvas id="gameCanvas" width="400" height="400"></canvas>
                </div>
                <div class="game-info">
                  <div>Score: <span id="score">0</span></div>
                  <div>High Score: <span id="highScore">0</span></div>
                </div>
                <div class="game-controls">
                  <button class="game-btn" id="startBtn">Start</button>
                  <button class="game-btn" id="pauseBtn">Pause</button>
                  <button class="game-btn" id="resetBtn">Reset</button>
                </div>
                <div class="instructions">
                  <p>Use Arrow Keys or WASD to control the snake</p>
                  <p>Eat food to grow and gain points</p>
                  <p>Hit walls or your own body to end the game</p>
                </div>
              </div>
            </p>
          </header>
        </div>
      </div>
    </div>
  </main>

  <!-- Game Over Modal -->
  <div class="game-over-modal" id="gameOverModal">
    <div class="game-over-content">
      <h2 class="game-over-title">GAME OVER</h2>
      <div class="game-over-score">Your Score: <span id="finalScore">0</span></div>
      <label class="name-input-label" for="playerName">Who are you?</label>
      <input 
        type="text" 
        id="playerName" 
        class="name-input" 
        placeholder="Enter your name..."
        maxlength="20"
        autocomplete="off"
      />
      <button class="submit-btn" id="submitScoreBtn">Submit Score</button>
    </div>
  </div>

  <script>
    // Game variables
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    const gridSize = 20;
    const tileCount = canvas.width / gridSize;

    let snake = [{ x: 10, y: 10 }];
    let food = {};
    let dx = 0;
    let dy = 0;
    let score = 0;
    let highScore = 0;
    let gameRunning = false;
    let gamePaused = false;
    let gameLoop = null;

    // Initialize game
    function initGame() {
      generateFood();
      loadHighScore();
      draw();
    }

    // Generate food at random position
    function generateFood() {
      food = {
        x: Math.floor(Math.random() * tileCount),
        y: Math.floor(Math.random() * tileCount)
      };
      // Make sure food doesn't spawn on snake
      for (let segment of snake) {
        if (segment.x === food.x && segment.y === food.y) {
          generateFood();
          return;
        }
      }
    }

    // Draw game
    function draw() {
      clearCanvas();
      drawSnake();
      drawFood();
    }

    function clearCanvas() {
      ctx.fillStyle = '#000000';
      ctx.fillRect(0, 0, canvas.width, canvas.height);
    }

    function drawSnake() {
      ctx.fillStyle = '#00ff00';
      for (let segment of snake) {
        ctx.fillRect(segment.x * gridSize, segment.y * gridSize, gridSize - 2, gridSize - 2);
      }
    }

    function drawFood() {
      ctx.fillStyle = '#ffffff';
      ctx.fillRect(food.x * gridSize, food.y * gridSize, gridSize - 2, gridSize - 2);
    }

    // Move snake
    function moveSnake() {
      if (dx === 0 && dy === 0) return;

      const head = { x: snake[0].x + dx, y: snake[0].y + dy };

      // Check wall collision
      if (head.x < 0 || head.x >= tileCount || head.y < 0 || head.y >= tileCount) {
        gameOver();
        return;
      }

      // Check self collision
      for (let segment of snake) {
        if (head.x === segment.x && head.y === segment.y) {
          gameOver();
          return;
        }
      }

      snake.unshift(head);

      // Check food collision
      if (head.x === food.x && head.y === food.y) {
        score += 10;
        updateScore();
        generateFood();
      } else {
        snake.pop();
      }
    }

    // Game loop
    function gameStep() {
      if (!gameRunning || gamePaused) return;
      moveSnake();
      draw();
    }

    // Start game
    function startGame() {
      if (gameRunning) return;
      gameRunning = true;
      gamePaused = false;
      gameLoop = setInterval(gameStep, 150);
      document.getElementById('startBtn').textContent = 'Playing...';
    }

    // Pause game
    function pauseGame() {
      if (!gameRunning) return;
      gamePaused = !gamePaused;
      document.getElementById('pauseBtn').textContent = gamePaused ? 'Resume' : 'Pause';
    }

    // Reset game
    function resetGame() {
      clearInterval(gameLoop);
      snake = [{ x: 10, y: 10 }];
      dx = 0;
      dy = 0;
      score = 0;
      gameRunning = false;
      gamePaused = false;
      updateScore();
      generateFood();
      draw();
      document.getElementById('startBtn').textContent = 'Start';
      document.getElementById('pauseBtn').textContent = 'Pause';
    }

    // Game over
    function gameOver() {
      clearInterval(gameLoop);
      gameRunning = false;
      document.getElementById('finalScore').textContent = score;
      document.getElementById('gameOverModal').style.display = 'flex';
      document.getElementById('playerName').focus();
    }

    // Update score display
    function updateScore() {
      document.getElementById('score').textContent = score;
      if (score > highScore) {
        highScore = score;
        document.getElementById('highScore').textContent = highScore;
      }
    }

    // Load high score from localStorage
    function loadHighScore() {
      const leaderboard = getLeaderboard();
      if (leaderboard.length > 0) {
        highScore = leaderboard[0].score;
        document.getElementById('highScore').textContent = highScore;
      }
    }

    function getLeaderboard() {
      const data = localStorage.getItem('snakeLeaderboard');
      if (!data) return [];
      const leaderboard = JSON.parse(data);
      return leaderboard.sort((a, b) => b.score - a.score).slice(0, 10);
    }

    // Save score to leaderboard
    function saveScore(name, score) {
      if (!name || name.trim() === '') {
        name = 'Anonymous';
      }
      name = name.trim().substring(0, 20);

      let leaderboard = JSON.parse(localStorage.getItem('snakeLeaderboard') || '[]');
      leaderboard.push({
        name: name,
        score: score,
        date: new Date().toISOString()
      });

      // Sort by score (descending)
      leaderboard.sort((a, b) => b.score - a.score);

      // Keep top 10
      leaderboard = leaderboard.slice(0, 10);

      localStorage.setItem('snakeLeaderboard', JSON.stringify(leaderboard));

      // Trigger storage event for cross-page updates
      window.dispatchEvent(new Event('storage'));
    }

    // Submit score
    function submitScore() {
      const name = document.getElementById('playerName').value;
      saveScore(name, score);
      document.getElementById('gameOverModal').style.display = 'none';
      document.getElementById('playerName').value = '';
      resetGame();
    }

    // Keyboard controls
    document.addEventListener('keydown', (e) => {
      if (!gameRunning || gamePaused) {
        if (e.key === ' ') {
          startGame();
        }
        return;
      }

      switch(e.key) {
        case 'ArrowUp':
        case 'w':
        case 'W':
          if (dy !== 1) { dx = 0; dy = -1; }
          break;
        case 'ArrowDown':
        case 's':
        case 'S':
          if (dy !== -1) { dx = 0; dy = 1; }
          break;
        case 'ArrowLeft':
        case 'a':
        case 'A':
          if (dx !== 1) { dx = -1; dy = 0; }
          break;
        case 'ArrowRight':
        case 'd':
        case 'D':
          if (dx !== -1) { dx = 1; dy = 0; }
          break;
        case ' ':
          pauseGame();
          break;
      }
    });

    // Submit on Enter key
    document.getElementById('playerName').addEventListener('keypress', (e) => {
      if (e.key === 'Enter') {
        submitScore();
      }
    });

    // Button event listeners
    document.getElementById('startBtn').addEventListener('click', startGame);
    document.getElementById('pauseBtn').addEventListener('click', pauseGame);
    document.getElementById('resetBtn').addEventListener('click', resetGame);
    document.getElementById('submitScoreBtn').addEventListener('click', submitScore);

    // Initialize
    initGame();
  </script>
</body>
</html>

